<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vote</title>
    <link rel="stylesheet" href="/css/style.css" />
  </head>
  <body>
    <div class="container">
      <div class="voter-view">
        <div id="waitingScreen" class="waiting-screen">
          <div class="waiting-message">
            <h2 id="waitingTitle">Waiting for host to start the session...</h2>
            <p id="waitingSubtitle">The session will begin shortly. Please wait.</p>
            <div class="spinner"></div>
          </div>
        </div>

        <div id="votingScreen" class="voting-screen hidden">
          <div style="display: flex; align-items: center; gap: 10px; justify-content: center; flex-wrap: wrap;">
            <div class="timer-display" id="timerDisplay">
              <span id="timerText">Time remaining: <strong id="timerValue">60</strong>s</span>
            </div>
            <div id="adminControls" class="hidden" style="display: none; gap: 5px; align-items: center;">
              <button id="voterPauseBtn" onclick="voterTogglePause()" class="btn btn-small" style="background: #ed8936; color: white; padding: 5px 10px; font-size: 12px;">
                Pause
              </button>
              <button id="voterSkipBtn" onclick="voterSkipPoll()" class="btn btn-small" style="background: #e53e3e; color: white; padding: 5px 10px; font-size: 12px;">
                Skip
              </button>
              <label style="display: flex; align-items: center; gap: 4px; cursor: pointer; font-size: 12px; background: #f0f8ff; padding: 5px 8px; border-radius: 4px; border: 1px solid #4a90e2;">
                <input type="checkbox" id="voterAutoAdvanceToggle" onchange="voterToggleAutoAdvance()" style="width: auto; cursor: pointer;" />
                <span style="color: #4a90e2; font-weight: 600;">Auto</span>
              </label>
            </div>
          </div>
          <h2 id="pollTitle"></h2>
          <div id="pollMedia" class="media-container"></div>

          <div class="rating-section">
            <label for="ratingInput">Your Rating (0-10):</label>
            <div class="rating-input-group">
              <input type="range" id="ratingSlider" min="0" max="10" value="5" />
              <input type="number" id="ratingInput" min="0" max="10" value="5" />
            </div>
            <button id="submitRatingBtn" class="btn btn-primary">Submit Rating</button>
            <div id="submitMessage" class="submit-message hidden"></div>
          </div>

          <!-- Expose Vote Section -->
          <div id="exposeSection" style="margin-top: 20px; padding: 15px; background: #fff3cd; border-radius: 8px; border: 1px solid #ffc107;">
            <div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 10px;">
              <div>
                <strong style="color: #856404;">Vote To Reveal</strong>
                <p style="margin: 5px 0 0 0; font-size: 14px; color: #856404;">
                  <span id="exposeVoteCount">0</span>/<span id="exposeVoteNeeded">0</span> votes to reveal who hasn't voted
                </p>
              </div>
              <button id="voteExposeBtn" class="btn" style="background: #ffc107; color: #856404; border: none; font-weight: 600;">
                Vote To Reveal üëÄ
              </button>
            </div>
            <div id="exposedResult" class="hidden" style="margin-top: 15px; padding: 15px; background: #f8d7da; border-radius: 8px; text-align: center;">
              <strong style="color: #721c24; font-size: 18px;" id="exposedTitle">Revealed!</strong>
              <p style="color: #721c24; margin: 10px 0 0 0; font-size: 16px;" id="exposedNames"></p>
            </div>
          </div>
        </div>

        <!-- Chat Panel -->
        <div id="chatPanel" class="chat-panel">
          <div class="chat-header" onclick="toggleChat()">
            <span>üí¨ Chat</span>
            <span id="chatBadge" class="chat-badge hidden">0</span>
            <span id="chatToggleIcon">‚ñº</span>
          </div>
          <div id="chatBody" class="chat-body hidden">
            <div id="chatMessages" class="chat-messages">
              <!-- Messages will be inserted here -->
            </div>
            <div class="chat-input-container">
              <input type="text" id="chatInput" placeholder="Type a message..." maxlength="500" />
              <button id="chatSendBtn" class="btn btn-primary">Send</button>
            </div>
          </div>
        </div>

        <!-- Top 10 Results Screen (shown before feedback) -->
        <div id="top10Screen" class="top10-screen hidden">
          <div class="top10-header">
            <h2 style="font-size: 2em; margin-bottom: 10px;">Top 10 Content of the Session</h2>
            <p style="font-size: 1.1em; color: #666;">Based on average ratings from all voters</p>
          </div>

          <!-- Congratulations for top creator -->
          <div id="topCreatorCongrats" class="top-creator-congrats hidden">
            <div class="congrats-content">
              <span class="trophy">üèÜ</span>
              <div class="congrats-text">
                <p class="congrats-label">Congratulations!</p>
                <p class="congrats-name" id="topCreatorName"></p>
                <p class="congrats-score">Highest average score: <strong id="topCreatorScore"></strong></p>
              </div>
              <span class="trophy">üèÜ</span>
            </div>
          </div>

          <div id="top10List" class="top10-list">
            <!-- Top 10 items will be inserted here -->
            <div class="loading-top10">
              <div class="spinner"></div>
              <p>Loading results...</p>
            </div>
          </div>

          <button id="continueToFeedbackBtn" class="btn btn-primary btn-large" style="margin-top: 20px;">
            Continue to Feedback
          </button>
        </div>

        <div id="endScreen" class="end-screen hidden">
          <div class="end-message">
            <h2 style="font-size: 2.5em; margin-bottom: 20px;">Thank you for joining us and voting!</h2>
            <p style="font-size: 1.5em; color: #555;">See you next Friday!!</p>
          </div>

          <!-- Feedback Form -->
          <div id="feedbackSection" class="feedback-section">
            <h3>We'd love your feedback!</h3>

            <!-- Question 1: Rating -->
            <div class="feedback-question">
              <label>How would you rate this week's Content Team Roundtable?</label>
              <div class="star-rating" id="contentRating">
                <span class="star" data-value="1">&#9733;</span>
                <span class="star" data-value="2">&#9733;</span>
                <span class="star" data-value="3">&#9733;</span>
                <span class="star" data-value="4">&#9733;</span>
                <span class="star" data-value="5">&#9733;</span>
              </div>
            </div>

            <!-- Question 2: Most valuable -->
            <div class="feedback-question">
              <label>What did you find most valuable about this meeting?</label>
              <textarea id="mostValuable" placeholder="Share what you found valuable..."></textarea>
            </div>

            <!-- Question 3: Improvements -->
            <div class="feedback-question">
              <label>What could be improved for future meetings?</label>
              <textarea id="improvements" placeholder="Share your suggestions for improvement..."></textarea>
            </div>

            <!-- Question 4: Meeting length -->
            <div class="feedback-question">
              <label>Was the meeting length appropriate?</label>
              <div class="option-buttons" id="meetingLengthOptions">
                <button type="button" class="option-btn" data-value="Yes">Yes</button>
                <button type="button" class="option-btn" data-value="No">No</button>
              </div>

              <!-- Expanded options when "No" is selected -->
              <div id="meetingLengthDetails" class="hidden" style="margin-top: 15px; padding: 15px; background: #fff; border-radius: 8px; border: 1px solid #e2e8f0;">
                <label style="margin-bottom: 10px;">Was it:</label>
                <div class="option-buttons" id="meetingLengthReason">
                  <button type="button" class="option-btn" data-value="Too short">Too short</button>
                  <button type="button" class="option-btn" data-value="Too long">Too long</button>
                </div>
                <div style="margin-top: 15px;">
                  <label>Do you have a suggestion to make it more appropriate? (Optional)</label>
                  <textarea id="meetingLengthSuggestion" placeholder="Share your suggestion..."></textarea>
                </div>
              </div>
            </div>

            <!-- Question 5: Additional comments -->
            <div class="feedback-question">
              <label>Any additional comments or suggestions? (Optional)</label>
              <textarea id="additionalComments" placeholder="Any other thoughts..."></textarea>
            </div>

            <p class="feedback-privacy">Your feedback is anonymous and helps us improve future sessions.</p>

            <button id="submitFeedbackBtn" class="btn btn-primary btn-large">
              Submit Feedback
            </button>

            <p id="feedbackMessage" class="submit-message hidden"></p>

            <button id="skipFeedbackBtn" class="btn btn-secondary" style="margin-top: 10px;">
              Skip Feedback
            </button>
          </div>

          <!-- Thank You Message (shown after submission) -->
          <div id="feedbackThanks" class="hidden">
            <p style="font-size: 1.3em; color: #48bb78; margin-top: 20px;">
              Thank you for your feedback!
            </p>
          </div>
        </div>
      </div>
    </div>

    <script src="/js/dark-mode.js"></script>
    <script src="/js/voter.js"></script>
  </body>
</html>
